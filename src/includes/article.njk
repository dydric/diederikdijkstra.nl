{% macro spotifyEmbed(
  postLinks = postLinks
) %}
  {% if postLinks %}
    {% for link in postLinks %}
      {% if link.link_type == "spotify_embed" %}
        <div class="iframe-holder spotify">
          <iframe class="iframe" src="{{ link.link_url }}" width="300" height="380" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe>
        </div>
      {% endif %}
    {% endfor %}
  {% endif %}
{% endmacro %}

{% macro audio(
  postImage = postImage,
  bodyContent = bodyContent,
  postLinks = postLinks
) %}
<div class="sm:flex">
  <div class="sm:flex-auto flex-shrink-0 sm:w-1/3 sm:pr-4 mb-6 sm:mb-0">
    {% if postImage %}
      {% cloudinaryImage
        site.url + postImage ,
        "f_auto,c_fill,g_faces:auto,w_896",
        "afbeelding van " + title,
        "block max-w-full mx-auto rounded"
      %}
    {% endif %}
  </div>
  <div class="sm:flex-initial sm:w-2/3 sm:pl-4">
    {{ spotifyEmbed(
      postLinks = postLinks
    ) }}
    {{ bodyContent | safe }}
  </div>
</div>
{% endmacro %}

{% macro article(
  postType = type,
  postTitle = title,
  postDate = page.date,
  postUrl = "",
  postTags = tags,
  postImage = thumbnail,
  bodyContent = content,
  postLinks = link
) %}

<article
  class="post{% if postType %} post--{{ postType }}{% endif %}"
  id="{{ postTitle | slug }}">
    <time datetime="{{ postDate.toISOString() }}">{{ postDate | fullDate }}</time>
    {%- if postUrl %}
      <h1><a href="{{ postUrl }}">{{ postTitle }}</a></h1>
    {%- else %}
      <h1>{{ postTitle }}</h1>
    {%- endif %}

    <div>
      {% if postTags %}
        {% for tag in postTags -%}
          {%- if tag not in site.filterTags %}
            <a href="/{{ site.rootCollections}}/tags/{{ tag }}/" class="tag">#{{ tag }}</a>
          {% endif -%}
        {%- endfor -%}
      {% endif %}
    </div>

    {% if postType == "audio" %}
      {{ audio(
        postImage = postImage,
        bodyContent = bodyContent,
        postLinks = postLinks
      ) }}
    {% else %}
      {% if postImage %}
        {% cloudinaryImage
          site.url + postImage  ,
          "f_auto,c_fill,g_faces:auto,w_896",
          "afbeelding van " + title,
          "block max-w-full mx-auto rounded"
        %}
        {{ spotifyEmbed(
          postLinks = postLinks
        ) }}
      {% endif %}
      {{ bodyContent | safe }}
    {% endif %}
  </article>

{% endmacro %}
